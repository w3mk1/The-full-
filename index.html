<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SNTF Go - Beni Mered/Agha</title>
    
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" />
    
    <style>
        :root { --p: #006d3a; --s: #f3f4f2; --c: #ffffff; --t: #1a1c19; --accent: #ffb400; }
        .dark-mode { --s: #111411; --c: #1c1f1c; --t: #e2e3dd; }

        body { background: var(--s); color: var(--t); font-family: 'Segoe UI', sans-serif; margin: 0; padding: 10px; transition: 0.3s; }
        .app-container { max-width: 500px; margin: auto; }
        
        .card { background: var(--c); border-radius: 24px; padding: 16px; margin-bottom: 12px; border: 1px solid rgba(0,0,0,0.05); }
        
        /* ØªØµÙ…ÙŠÙ… Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø²Ù…Ù†ÙŠ */
        .time-row { display: flex; justify-content: space-between; align-items: center; padding: 12px 0; border-bottom: 1px solid rgba(0,0,0,0.05); }
        .time-badge { background: var(--p); color: white; padding: 4px 12px; border-radius: 8px; font-weight: bold; }
        .next-trip { border: 2px solid var(--p); background: #e8f5e9; }

        .station-timeline { border-right: 2px solid var(--p); margin: 20px 10px; padding-right: 20px; }
        .station-node { position: relative; padding-bottom: 20px; }
        .station-node::before { 
            content: ''; position: absolute; right: -27px; top: 5px; 
            width: 12px; height: 12px; border-radius: 50%; background: var(--p); border: 3px solid var(--c);
        }

        #map { height: 200px; border-radius: 16px; margin-bottom: 15px; }
        .btn-action { background: var(--p); color: white; border: none; width: 100%; padding: 16px; border-radius: 12px; font-weight: bold; cursor: pointer; }
        
        .status-chip { display: inline-block; padding: 2px 8px; border-radius: 50px; font-size: 0.8rem; background: var(--accent); color: #000; margin-bottom: 5px; }
    </style>
</head>
<body class="light-mode">

<div class="app-container">
    <header style="display: flex; justify-content: space-between; align-items: center; padding: 10px;">
        <h2 style="margin:0"><i class="fas fa-train"></i> SNTF Connect</h2>
        <button onclick="document.body.classList.toggle('dark-mode')" style="background:none; border:none; font-size:1.2rem;">ğŸŒ™</button>
    </header>

    <div class="card next-trip">
        <span class="status-chip"><i class="fas fa-bolt"></i> Ø§Ù„Ø±Ø­Ù„Ø© Ø§Ù„Ù‚Ø§Ø¯Ù…Ø© Ø§Ù„Ø¢Ù†</span>
        <div style="display: flex; justify-content: space-between; align-items: center;">
            <div>
                <h3 style="margin:0">06:45</h3>
                <small>Ø¨Ù†ÙŠ Ù…Ø±Ø§Ø¯ â®• Ø¢ØºØ§</small>
            </div>
            <div style="text-align: left;">
                <span id="countdown" style="font-weight: bold; color: var(--p);">--:--</span>
            </div>
        </div>
    </div>

    <div class="card">
        <div id="map"></div>
        <div class="station-timeline" id="timeline"></div>
    </div>

    <div class="card">
        <h4 style="margin-top:0"><i class="fas fa-calendar-alt"></i> Ø¬Ø¯ÙˆÙ„ Ù…ÙˆØ§Ø¹ÙŠØ¯ Ø§Ù„ÙŠÙˆÙ…</h4>
        <div id="schedule-list"></div>
    </div>
</div>

<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<script>
    // 1. Ù‚Ø§Ø¹Ø¯Ø© Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø­Ø·Ø§Øª Ø§Ù„Ø¯Ù‚ÙŠÙ‚Ø©
    const stations = [
        { name: "Ø¨Ù†ÙŠ Ù…Ø±Ø§Ø¯", lat: 36.5050, lng: 2.8610 },
        { name: "Ø¨ÙˆÙØ§Ø±ÙŠÙƒ", lat: 36.5744, lng: 2.9119 },
        { name: "Ø¨Ø¦Ø± ØªÙˆØªØ©", lat: 36.6433, lng: 2.9872 },
        { name: "Ø§Ù„Ø­Ø±Ø§Ø´", lat: 36.7200, lng: 3.1300 },
        { name: "Ø­Ø³ÙŠÙ† Ø¯Ø§ÙŠ", lat: 36.7450, lng: 3.0800 },
        { name: "Ø§Ù„Ø¬Ø²Ø§Ø¦Ø± - Ø¢ØºØ§", lat: 36.7645, lng: 3.0515 }
    ];

    // 2. Ù…ÙˆØ§Ù‚ÙŠØª Ø§Ù„Ø±Ø­Ù„Ø§Øª (Ù…Ø­Ø§ÙƒØ§Ø© Ù„Ù„ÙˆØ§Ù‚Ø¹)
    const tripTimes = ["06:10", "06:45", "07:20", "08:00", "09:30", "12:15", "15:40", "17:10"];

    function initApp() {
        renderTimeline();
        renderSchedule();
        initMap();
        startCountdown();
    }

    function renderTimeline() {
        const container = document.getElementById('timeline');
        container.innerHTML = stations.map(s => `
            <div class="station-node">
                <strong>${s.name}</strong>
            </div>
        `).join('');
    }

    function renderSchedule() {
        const list = document.getElementById('schedule-list');
        list.innerHTML = tripTimes.map(time => `
            <div class="time-row">
                <span>Ø§Ù„Ø¬Ø²Ø§Ø¦Ø± Ø§Ù„Ø¹Ø§ØµÙ…Ø© (Ø¢ØºØ§)</span>
                <span class="time-badge">${time}</span>
            </div>
        `).join('');
    }

    function initMap() {
        map = L.map('map', {zoomControl: false}).setView([36.65, 3.0], 10);
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png').addTo(map);
        
        const pathCoords = stations.map(s => [s.lat, s.lng]);
        L.polyline(pathCoords, {color: '#006d3a', weight: 5}).addTo(map);
        
        L.marker(pathCoords[0]).addTo(map).bindPopup("Ø§Ù†Ø·Ù„Ø§Ù‚");
        L.marker(pathCoords[pathCoords.length-1]).addTo(map).bindPopup("ÙˆØµÙˆÙ„");
    }

    function startCountdown() {
        setInterval(() => {
            const now = new Date();
            // Ù‡Ù†Ø§ ÙŠÙ…ÙƒÙ† Ø±Ø¨Ø·Ù‡Ø§ Ø¨Ø§Ù„ÙˆÙ‚Øª Ø§Ù„ÙØ¹Ù„ÙŠ Ù„Ø­Ø³Ø§Ø¨ Ø§Ù„ÙØ±Ù‚ Ù…Ø¹ Ø£Ù‚Ø±Ø¨ Ø±Ø­Ù„Ø©
            document.getElementById('countdown').innerText = "Ø¯Ù‚Ø§Ø¦Ù‚ 12"; 
        }, 1000);
    }

    window.onload = initApp;
</script>
</body>
</html>
